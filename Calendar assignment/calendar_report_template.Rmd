---
title: "YOUR TITLE HERE"
subtitle: "Stat231: Google Calendar Report"
author: "Thai Nguyen"
date: "Due Friday, September 25 by 5:00 PM EST"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# How do I spend my time?

```{r}
# include your import of the data and preliminary wrangling here

# importing data
library(tidyverse)
library(lubridate)
library(ical)
path <- "/Users/thainguyen/Desktop/STUDYYYYYYYYYYYYYYYYYYYYYY/College/Fall 2020/Data Science STAT 231/Git/Stat-231-repo/Calendar assignment"
filename <- "Test schedule.ics"

my_calendar0 <- ical_parse_df(file = paste0(path,"/",filename)) %>%
  mutate(length_second = end - start
    , date = floor_date(start, unit = "day"))


```

```{r}
# initial data wrangling
names(my_calendar0)
my_calendar <- my_calendar0 %>%
  filter(date > "2020-09-01") %>%
  select(-c(uid, description, last.modified, status)) %>%
  mutate(length_hour = as.numeric(length_second / 3600)) %>%
  mutate(activity = summary) %>%
  select(activity, date, length_hour) %>%
  group_by(date, activity) %>%
  summarise(length_hour = sum(length_hour)) 

  
  
  
#  pivot_wider(id_cols = summary, names_from = date, values_from = length_hour)

```


Describe your question(s) here.  Briefly describe your data collection process, including how you defined variables of interest.

In this assignment I aimed to answer 3 questions:
\begin{enumerate}
  \vskip 0.05in
  \item \textbf{Did I structure my working time according to Pomodoro technique?} 
  \vskip 0.05in
  Firstly, the Pomodoro technique is a time management technique to help people stop procrastinating and have efficient working sessions by segmenting working hours into smaller blocks of time (called Pomodoro), with breaks in between Pomodoros in order to make sure you don't overwork. Generally, a Pomodoro is about 25 minutes, followed by a period of rest of 5 minutes, but you can combine into bigger Pomodoros and bigger rest (50 - 10, 1h15 - 15), as long as after a period of 4 Pomodoros, you will take a large break (20 minutes) to refresh yourself for the next session. \\
  In this question, I attempt to see whether I have worked according to the Pomodoro technique. To simplify matters, I will define days meeting the criteria of Pomodoro to be days which ratio of working hours to rest hours in learning sessions is equal to 5:2 = 2.5 (As 4 Pomodoros will be 100 minutes, you have 3 small rests of 5 minutes each and one large rest of 25 minutes, total rest time is 40 minutes). \\
  Working hours are recorded as variable \textit{Work}, and it records any kind of time that I count as working hours that are not externally structured (so class time won't count as work, as class time is scheduled by the College). \\
  Rest hours are a bit more complicated. We have the usual \textit{Rest} that records the rest time in between Pomodoros. In additions, as I carry out the sessions, I realized the need to record down another variable, \textit{Idle}, which records down the time which I idle before beginning work. We will observe the success of the Pomodoro technique if we just consider \textit{Rest}, and then see how the results change when we add in \textit{Idle}.
  
  \item \textbf{Does having a class in the middle of the night affect work performance the next day?}
  \vskip 0.05in 
  As an international student studying remotely from Vietnam, the timezone differences are making my life rather difficult as I have to wake up in the middle of my sleep to attend classes. Even though I try to sleep immediately when the class ends and get adequate amount of sleep every night, I still feel rather groggy and distracted the next morning. In this question I will try to see if my performance is lower on days where I have classes in the middle of the night in comparison to days where I get uninterrupted sleep.
  
  \item \textbf{Does working harder make gymming less attractive an activity?}
  \vskip 0.05in
  My hypothesis is that on days where I work harder (number of work hours are higher), I will not be as motivated to do a hard work out, and instead would opt for a run. The variable \textit{Gym} records the length of the gymming session. If the session is less than an hour, it is a run; if more than an hours, it's a gymming session. I want to regress \textit{Work} against \textit{Gym} to see if this is true.
  \end{enumerate}

Describe what information is conveyed through data visualization #1 (that you'll create below) here.

```{r}
my_calendar1 <- my_calendar %>%
  filter(activity == "Idle" | activity == "Rest"|activity == "Work") %>%
  pivot_wider(id_cols = date, names_from = activity, values_from = length_hour) %>%
  mutate(pomo_ratio1 = Work/Rest) %>%
  mutate(pomo_ratio2 = Work/(Rest + Idle))
  

plot1 <- my_calendar1 %>% 
  ggplot(aes(x = date)) +
  geom_line(aes(y = pomo_ratio1), color = "red") + 
  geom_line(aes(y = pomo_ratio2), color = "blue") +
  geom_hline(yintercept = 2.5, linetype = "dashed") +
  xlab("Date") +
  ylab("Ratio of work over rest time")
  
plot1
```

Describe what information is conveyed through data visualization #2 (that you'll create below) here.

```{r}
# Write your code to create data visualization #2 here.  
# Be sure to label your axes and include a title to give your data's context.
```

Describe what information is conveyed through the table (that you'll create below) here.

```{r, results='asis'}
# write your code to create the table here
# if you want to make your table's appearance nicer, check out:
# the xtable package (https://cran.r-project.org/web/packages/xtable/vignettes/xtableGallery.pdf); or
# the kable function in the knitr package (https://bookdown.org/yihui/rmarkdown-cookbook/kable.html)
```

To conclude, briefly summarize what you found in response to the questions posed here.

\newpage
# Reflection

Write your one-page reflection here in paragraph form.  In particular, address:

- What difficulties in the data collection and analysis process did you encounter?  Identify two of your main hurdles in gathering accurate data.
- What implications does that have for future data collection and/or analysis projects? 
- How much data do you think you'd need to collect in order to answer your question(s) of interest? Would it be hard to collect that data? Why or why not?
- As someone who provides data, what expectations do you have when you give your data (e.g. to Facebook, Google, MapMyRun, etc.)?  
- As someone who analyzes others' data, what ethical responsibilities do you have?



